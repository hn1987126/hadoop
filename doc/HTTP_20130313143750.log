1363157985066 	13726230503	00-FD-07-A4-72-B8:CMCC	120.196.100.82	i02.c.aliimg.com		24	27	2481	24681	200
1363157995052 	13826544101	5C-0E-8B-C7-F1-E0:CMCC	120.197.40.4			4	0	264	0	200
1363157991076 	13926435656	20-10-7A-28-CC-0A:CMCC	120.196.100.99			2	4	132	1512	200
1363154400022 	13926251106	5C-0E-8B-8B-B1-50:CMCC	120.197.40.4			4	0	240	0	200
1363157993044 	18211575961	94-71-AC-CD-E6-18:CMCC-EASY	120.196.100.99	iface.qiyi.com	视频网站	15	12	1527	2106	200
1363157995074 	84138413	5C-0E-8B-8C-E8-20:7DaysInn	120.197.40.4	122.72.52.12		20	16	4116	1432	200
1363157993055 	13560439658	C4-17-FE-BA-DE-D9:CMCC	120.196.100.99			18	15	1116	954	200
1363157995033 	15920133257	5C-0E-8B-C7-BA-20:CMCC	120.197.40.4	sug.so.360.cn	信息安全	20	20	3156	2936	200
1363157983019 	13719199419	68-A1-B7-03-07-B1:CMCC-EASY	120.196.100.82			4	0	240	0	200
1363157984041 	13660577991	5C-0E-8B-92-5C-20:CMCC-EASY	120.197.40.4	s19.cnzz.com	站点统计	24	9	6960	690	200
1363157973098 	15013685858	5C-0E-8B-C7-F7-90:CMCC	120.197.40.4	rank.ie.sogou.com	搜索引擎	28	27	3659	3538	200
1363157986029 	15989002119	E8-99-C4-4E-93-E0:CMCC-EASY	120.196.100.99	www.umeng.com	站点统计	3	3	1938	180	200
1363157992093 	13560439658	C4-17-FE-BA-DE-D9:CMCC	120.196.100.99			15	9	918	4938	200
1363157986041 	13480253104	5C-0E-8B-C7-FC-80:CMCC-EASY	120.197.40.4			3	3	180	180	200
1363157984040 	13602846565	5C-0E-8B-8B-B6-00:CMCC	120.197.40.4	2052.flash2-http.qq.com	综合门户	15	12	1938	2910	200
1363157995093 	13922314466	00-FD-07-A2-EC-BA:CMCC	120.196.100.82	img.qfc.cn		12	12	3008	3720	200
1363157982040 	13502468823	5C-0A-5B-6A-0B-D4:CMCC-EASY	120.196.100.99	y0.ifengimg.com	综合门户	57	102	7335	110349	200
1363157986072 	18320173382	84-25-DB-4F-10-1A:CMCC-EASY	120.196.100.99	input.shouji.sogou.com	搜索引擎	21	18	9531	2412	200
1363157990043 	13925057413	00-1F-64-E1-E6-9A:CMCC	120.196.100.55	t3.baidu.com	搜索引擎	69	63	11058	48243	200
1363157988072 	13760778710	00-FD-07-A4-7B-08:CMCC	120.196.100.82			2	2	120	120	200
1363157985066 	13726238888	00-FD-07-A4-72-B8:CMCC	120.196.100.82	i02.c.aliimg.com		24	27	2481	24681	200
1363157993055 	13560436666	C4-17-FE-BA-DE-D9:CMCC	120.196.100.99			18	15	1116	954	200

#### 放到hdfs中的只需要把上面的那一段剪走。
#### 上面的字段大致解释，时间戳，手机号，串号，ip，访问网站，网站名称，上行数量，下行数量，上行流量，下行流量，网站返回码


 作业：1/统计每一个用户（手机号）所耗费的总上行流量、下行流量，总流量
 map
 读一行，切分字段
 抽取手机号，上行流量 下行流量
 context.write(手机号,bean)

 reduce

 
 
 
 2/得出上题结果的基础之上再加一个需求：将统计结果按照总流量倒序排序

 这是问题1统计的结果
13480253104	540	540	1080
13502468823	22005	331047	353052
13560436666	3348	2862	6210
13560439658	6102	17676	23778
13602846565	5814	8730	14544
13660577991	20880	2070	22950
13719199419	720	0	720
13726230503	443	74043	81486
13726238888	7443	74043	81486
13760778710	360	360	720
13826544101	792	0	792
13922314466	9024	11160	20184
13925057413	33174	144729	177903
13926251106	720	0	720
13926435656	396	4536	4932
15013685858	10977	10614	21591
15920133257	9468	8808	18276
15989002119	5814	540	6354
18211575961	4581	6318	10899
18320173382	28593	7236	35829
84138413	12348	4296	16644
 
 
 
 
 
 
 3/将统计结果按照手机归属地不同省份输出到不同文件中
  map
  读一行，切分字段
 抽取手机号，上行流量 下行流量
 context.write(手机号,bean)
 
 
 map输出的数据要分成6个区
 重写partitioner，让相同归属地的号码返回相同的分区号int
 
 
 
 
6省    跑6个reduce task 
reduce
拿到一个号码所有数据
遍历，累加
输出
 
 
 
4、rjoin，订单和产品联合查询需求。

order.txt
1001,20150710,P0001,2
1002,20150710,P0001,3
1002,20150710,P0002,3
1002,20150710,P0003,3
1003,20150710,P0002,3

product.txt
P0001,苹果7,1000,5999
P0002,苹果6s,1000,4999
P0003,苹果6,1000,3999


5、索引 index

6、好友
A:B,C,D,E,F
B:A,C,E
C:F,A,D
D:A,E,F
E:B,C,D
F:A,B,C,D,E
 
7、日志清理
日志文件为：/Users/chen/java/bigdata_doc/access.log.fensi

8、订单按所购的商品的成交额排序
a.txt

Order_0000001,Pdt_01,222.8
Order_0000001,Pdt_05,25.8
Order_0000002,Pdt_05,325.8
Order_0000002,Pdt_03,522.8
Order_0000002,Pdt_04,122.4
Order_0000003,Pdt_01,222.8





9、logenhance项目(日志增强)
a.txt

http://www.jd.com
http://house.sina.com.cn
http://www.jiayucn.com
http://www.baidu.com
http://www.ali.com
http://www.yongche.com
http://www.jiayuan.com


数据库
-- ----------------------------
-- Table structure for url_rule
-- ----------------------------
DROP TABLE IF EXISTS `url_rule`;
CREATE TABLE `url_rule` (
  `url` varchar(2000) DEFAULT NULL,
  `content` varchar(255) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


insert into url_rule values('http://www.jd.com', '京东');
insert into url_rule values('http://house.sina.com.cn', '新浪房产');
insert into url_rule values('http://www.jiayuan.com', '世纪佳缘');
insert into url_rule values('http://www.yongche.com', '易到用车');




 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 